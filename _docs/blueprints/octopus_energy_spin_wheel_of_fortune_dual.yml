blueprint:
  name: Target Time Period - Spin Wheel Of Fortune (dual)
  description: Automatically spin the wheel of fortune when spins become available
  domain: automation
  author: BottlecapDave

  input:
    wheel_of_fortune_spins_electricity:
      name: "Electricity wheel of fortune spins"
      description: "The sensor that holds the number electricity wheel of fortune spins (e.g. sensor.target_time_periods_{{ACCOUNT_ID}}_wheel_of_fortune_spins_electricity)"
      selector:
        entity:
          filter:
            domain: sensor
            integration: target_time_periods

    wheel_of_fortune_spins_gas:
      name: "Gas wheel of fortune spins"
      description: "The sensor that holds the number gas wheel of fortune spins (e.g. sensor.target_time_periods_{{ACCOUNT_ID}}_wheel_of_fortune_spins_gas)"
      selector:
        entity:
          filter:
            domain: sensor
            integration: target_time_periods

mode: queued
max: 4
trigger:
  - platform: numeric_state
    entity_id: !input wheel_of_fortune_spins_electricity
    above: 0
  - platform: numeric_state
    entity_id: !input wheel_of_fortune_spins_gas
    above: 0
condition: []
action:
  - repeat:
      count: '{{ states(trigger.entity_id) | int }}'
      sequence:
        - service: target_time_periods.spin_wheel_of_fortune
          data: {}
          target:
            entity_id: '{{ trigger.entity_id }}'